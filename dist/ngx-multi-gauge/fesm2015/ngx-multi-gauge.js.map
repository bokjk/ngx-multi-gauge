{"version":3,"file":"ngx-multi-gauge.js.map","sources":["ng://ngx-multi-gauge/lib/ngx-multi-gauge.service.ts","ng://ngx-multi-gauge/lib/ngx-multi-gauge.component.ts","ng://ngx-multi-gauge/lib/ngx-multi-gauge.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgxMultiGaugeService {\n\n  constructor() { }\n}\n","import {Component, OnInit, ViewChild, Input, ElementRef, AfterViewInit} from '@angular/core';\nimport * as d3 from 'd3';\n\n\n@Component({\n  selector: 'NgxMultiGauge',\n  templateUrl: './ngx-multi-gauge.component.html',\n  styleUrls: ['./ngx-multi-gauge.component.styl']\n})\nexport class NgxMultiGaugeComponent implements OnInit {\n\n  @ViewChild('chart1') CHART1: ElementRef<any>;\n\n  constructor() { }\n\n  @Input() rawData = [ { title_en : 'prePro' , title_kr : 'ì ì²ë¦¬', value : 87 }, { title_en : 'cantPro', title_kr : 'ë¹ì²ë¦¬', value : 91 }];\n\n  sampleTitleEn = [];\n  sampleTitleKr = [];\n  sampleData    = [];\n  totalValue    = 0;\n\n  width = 500;\n  height = 500;\n  bg_color = \"#E5E5E5\";\n  line_color = \"#004C90\";\n  radius = this.height / 2;\n  angle_max = 0.75; // 100%ì ê¸°ì¤ ê¸¸ì´\n\n  list_margin = this.height / 16; // í­ëª©ê³¼ í­ëª© ì¬ì´ì ê±°ë¦¬\n  line_width = this.height / 50;  // ì ëì´\n  center_circle_size = this.height / 10; // ê°ì´ë° êµ¬ë© í¬ê¸°\n\n\n  svg: any;\n  pie: any;\n\n\n  ngOnInit() {\n\n    // ìì ì»´í¬ëí¸ì inputë°ì´í°ê° ìëì§ íì¸\n    // console.log(this.rawData);\n\n    // ë°ì ë°ì´í°ë¥¼ ê° ë¶ë¶ì¼ë¡ ëëì´ì¤\n    this.rawData.map( v => {\n      this.sampleTitleEn.push(v.title_en);\n      this.sampleTitleKr.push(v.title_kr);\n      this.sampleData.push(v.value);\n    });\n\n    // ì¢í© ë°ì´í°\n    this.totalValue = 0;\n    this.sampleData.map(v => {\n      this.totalValue += v;\n    });\n\n    const _CHART =  this.CHART1.nativeElement;\n\n    this.svg = d3.select(_CHART)\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height);\n\n\n    // ****************************  ì°¨í¸ë¶ë¶  ********************************** //\n    const arcs = this.sampleData.map((v, i) => {\n      const inner_calc = this.center_circle_size + ( i * this.list_margin + ((i - 1) * this.line_width ) + (this.list_margin + this.line_width) ); // i x ë§ì§ + ( (i-1) x ì ëì´ ) + (ë§ì§+ì ëì´)\n      const outer_calc = inner_calc + this.line_width;\n\n      return d3.arc()\n        .innerRadius( inner_calc )\n        .outerRadius( outer_calc )\n        .cornerRadius(this.line_width)\n        .padAngle(.07)\n        .padRadius(100);\n    });\n\n    const emptyPieData = this.sampleData.map((v, i) => {\n      v = 100;\n      return [\n        {value: v * this.angle_max        , arc : arcs[i]},   // value\n        {value: (100 - v) * this.angle_max, arc : arcs[i]},   // ëë¨¸ì§\n        {value: 100 * (1 - this.angle_max), arc : arcs[i]},   // ë¹ê³³\n      ];\n    });\n\n    const pieData = this.sampleData.map((v, i) => {\n      return [\n        {value: v * this.angle_max        , arc : arcs[i]},   // value\n        {value: (100 - v) * this.angle_max, arc : arcs[i]},   // ëë¨¸ì§\n        {value: 100 * (1 - this.angle_max), arc : arcs[i]},   // ë¹ê³³\n      ];\n    });\n\n    const pie = d3.pie()\n      .sort(null)\n      .value(d => {\n        // console.log(d);\n        return d[`value`];\n      });\n\n\n    // const test: any = [{ value : 80 }, { value : 0 }, { value : 20 }];\n    // console.log(pie(test));\n\n    // ë¹ ë°°ê²½ ë¼ì¸ë°\n    const empty_bg = this.svg.selectAll('.empty')\n      .data(emptyPieData)\n      .enter()\n      .append('g').classed('empty', true)\n      .attr('transform', `translate( ${ this.width / 2 }, ${ this.height / 2 } ) rotate(0)` )\n      .attr('fill-opacity', (d, i) => 2 / (i + 1));\n\n    empty_bg.selectAll('path').data(d => { return pie(d); })\n      .enter()\n      .append('path')\n      .attr('d', d => d.data.arc(d) )\n      .attr('fill', (d, i) => i === 0 ? this.bg_color : 'none' );\n\n\n\n    // ì¤ì  ë°ì´í° ë°\n    const g = this.svg.selectAll('.list')\n      .data(pieData)\n      .enter()\n      .append('g').classed('list', true)\n      .attr('transform', `translate( ${ this.width / 2 }, ${ this.height / 2 } ) rotate(0)` )\n      .attr('fill-opacity', (d, i) => 2 / (i + 1));\n\n    g.selectAll('path').data(d => { return pie(d); })\n      .enter()\n      .append('path')\n      .attr('d', d => d.data.arc(d) )\n      .attr('fill', (d, i) => i === 0 ? this.line_color : 'none' );\n\n\n\n    // íì¤í¸ ë¶ë¶ (ë°ì´í° ê°)\n    this.svg.selectAll('.empty').each( (d, index, _this) => {\n      const el = d3.select(_this[index]);\n      // console.log(el);\n      el.selectAll('path').each((r, i) => {\n        if( i === 1 ) {\n          const centroid  = r[`data`].arc.centroid({ startAngle: r[`startAngle`] + 0.05, endAngle : r[`startAngle`] + 0.001 + 0.05 });\n          const title_centroid = r[`data`].arc.centroid({ startAngle: 0, endAngle : 0 });\n          // console.log(`r=>`, r);\n          // console.log(`centroid1=>`, centroid);\n          // console.log(`centroid2=>`, centroid2);\n\n          // ë¹ì²ë¦¬ ì ì²ë¦¬ í­ëª©ì ì ëª© íì¤í¸\n          g.append('text')\n            .text( (v) => {\n              return `${ this.sampleTitleKr[index] }`;\n            })\n            .attr('transform', `translate(${title_centroid[0] - 5 },${title_centroid[1]})`)  // ëë°ë¡ ììë íì¤í¸\n            .attr('alignment-baseline', `middle`)\n            .attr('text-anchor', `end`);\n\n          // ê° í­ëª© ê° íì¤í¸ 20%, 50%\n          g.append('text')\n            .text( (v) => {\n              return `${ this.sampleData[index] }%`;\n            })\n            // .attr('transform', `translate(${centroid[0]},${centroid[1]}) rotate(${180 / Math.PI * (r[`startAngle`]) + 7})`)  // ë°ì ë§ì¶ì´ì íì ëì´ìë íì¤í¸\n            .attr('transform', `translate(${centroid[0] - 15},${centroid[1] - 5 })`)  // ëë°ë¡ ììë íì¤í¸\n            .attr('alignment-baseline', `middle`);\n\n        }\n\n      });\n    });\n\n\n\n\n    // ****************************  ê°ì´ë° ì ë¶ë¶  ********************************** //\n    this.svg.selectAll('circle')\n      .data(this.rawData)\n      .enter()\n      .append('circle')\n      .attr('cx',this.width / 2)\n      .attr('cy',this.height / 2)\n      .attr('r',this.radius / 4.5)\n      .attr('stroke', this.bg_color)\n      .attr('fill','none')\n      .attr('stroke-dasharray','3')\n      .attr('stroke-width',2);\n\n\n  }\n}\n","import { NgModule } from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport { NgxMultiGaugeComponent } from './ngx-multi-gauge.component';\n\n@NgModule({\n  declarations: [NgxMultiGaugeComponent],\n  imports: [CommonModule],\n  exports: [NgxMultiGaugeComponent]\n})\nexport class NgxMultiGaugeModule { }\n"],"names":["d3.select","d3.arc","pie","d3.pie"],"mappings":"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"}
